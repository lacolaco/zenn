---
title: "コンポーネント"
free: true
---

この章ではAngularの語彙としての「コンポーネント」について解説する。公式ドキュメントの用語集では、コンポーネントは次のように説明されている。

> A class with the @Component() decorator that associates it with a companion template.

つまり、コンポーネントとは [`@Component()`][] デコレーターが付与され、対応するテンプレートを備えたクラスである。端的にいえばそれだけだが、ではその `@Component()` デコレーターはコンポーネントとその他のクラスとの間にどのような違いをもたらすのだろうか。

## コンポーネントはテンプレートによってビューを定義する

[ビュー](1-view)で述べたとおり、コンポーネントは**コンポーネントビュー**を生成する。コンポーネントビューはコンポーネントクラスとそのテンプレートによって定義される。また、コンポーネントはテンプレート中で他のコンポーネントを呼び出すことで階層構造をつくる。アプリケーションの起動 (bootstrap) に使われる**ルートコンポーネント**を起点に作られる階層構造は**コンポーネントツリー**と呼ばれる。

コンポーネントがビューを定義するということは、すなわちコンポーネントがビューとしてのライフサイクルを持つということである。[`OnInit`][] や[`OnDestroy`][] といったコンポーネントの**ライフサイクルフックメソッド**は、そのコンポーネントに紐付いたビューのライフサイクルに合わせて任意の処理を追加するためのインターフェースである。つまり、ライフサイクルフックメソッドの呼び出しはビューに起因している。

コンポーネントとテンプレートがビューを定義するということから、コンポーネントとビューが主従関係にあるように見えるかもしれないが、アプリケーションの実行時にはむしろビューの方が主であり、コンポーネントが従である。変更検知に介入する [`ChangeDetectorRef`][] や DOM要素の参照が得られる[`ElementRef`][] なども、ビューからコンポーネントに向けて提供されているAPIである。

## コンポーネントはディレクティブの特殊な形である

コンポーネントはディレクティブでもある。ディレクティブはAngularが構築するビューに何かしらの作用を与えるクラスだが、その中でもビューを生成することができる特殊なディレクティブがコンポーネントである。なぜビューを生成できるかといえば、コンポーネントがテンプレートを持つからである。つまり、**コンポーネントとはテンプレートを持つディレクティブである**。

あらゆるディレクティブはひとつのDOM要素に紐付く形で機能する。このDOM要素をディレクティブの**ホスト要素**と呼び、コンポーネントも例外ではない。ディレクティブとしてのコンポーネントのホスト要素は、そのコンポーネント自身が生成するDOM要素である。一方で、コンポーネント以外のテンプレートを持たないディレクティブは、すでに存在するDOM要素に対してアタッチする形でホスト要素と紐づく。ディレクティブのクラスだけがインジェクトできる `ElementRef` は、そのディレクティブのホスト要素の参照を返すAPIである。このようなディレクティブ特有の機能は、コンポーネントにおいても例外なく利用可能である。

言いかえれば、ディレクティブにはないコンポーネント特有の性質というのは、テンプレートとそれに紐付くコンポーネントビューに関連するものだけである。具体的には、CSSのカプセル化やアニメーション、変更検知戦略など、 `@Component()` デコレーターにあって [`@Directive()`][] デコレーターにないプロパティがそれにあたる。それ以外はすべてディレクティブとしての性質だ。

したがって、コンポーネントについて深く学ぼうとするなら、ディレクティブを理解することから始めなければならない。

[変更検知]: https://angular.jp/guide/glossary#%E5%A4%89%E6%9B%B4%E6%A4%9C%E7%9F%A5
[`@Component()`]: https://angular.jp/api/core/Component
[`@Directive()`]: https://angular.jp/api/core/Directive
[`OnInit`]: https://angular.jp/api/core/OnInit
[`OnDestroy`]: https://angular.jp/api/core/OnDestroy
[`ChangeDetectorRef`]: https://angular.jp/api/core/ChangeDetectorRef
[`ElementRef`]: https://angular.jp/api/core/ElementRef